<!DOCTYPE html>
<html>

   <head>

      <title></title>

      <meta charset="utf-8" />

      <link rel="stylesheet" href="../../../../tools/libs/js/jquery/qunit/qunit-1.10.0.css" type="text/css" />
      <script type="text/javascript" src="../../../../tools/libs/js/jquery/jquery-1.8.2.js"></script>
      <script type="text/javascript" src="../../../../tools/libs/js/jquery/qunit/qunit-1.10.0.js"></script>

      <script type="text/javascript" src="../../../src/base/NS.js"></script>
      <script type="text/javascript" src="../../../src/base/inheritance/Inherit.js"></script>

      <script type="text/javascript">
                 
         jQuery(document).ready(function() {
            
            var Inherit = base.inheritance.Inherit;
            
            QUnit.testStart = function() {     
               
               // GLOBAL
               window.Human = function(name) {
                  this.name = name;
                  this.unreacheableIFOverridden = function() {
                     return true;
                  }
               }

               Human.prototype.sayName = function() {
                  return this.name;
               }

               Human.prototype.walk = function() {
                  return Human.WALKING_LABEL;
               }

               // GLOBAL
               window.FrenchMan = function(name) {
                  Human.call(this, name);
               }

               Inherit.classically(Human, FrenchMan, {
                  sayHello: function() {
                     return FrenchMan.GREETING_PREFIX + " " + this.sayName();
                  }
               });
               
               Human.WALKING_LABEL = "I am walking";
               FrenchMan.WALKING_LABEL = "je marche";
               FrenchMan.GREETING_PREFIX = "Bonjour, je suis";               
            };
            
            QUnit.testDone = function() {
               console.log("test tearDown");
               delete(window.Human);
               delete(window.FrenchMan);
            };
            
            test("checking overriding methods and the access the overridden ones", function() {             
            
               var fabs = new Human("Fabs");
               var laurent = new FrenchMan("Laurent");

               // walk() now overridden
               FrenchMan.prototype.walk = function() {
                  return FrenchMan.WALKING_LABEL;
               }

               ok(fabs.walk() === Human.WALKING_LABEL); // fabs keep the old version
               ok(laurent.walk() === FrenchMan.WALKING_LABEL); // laurent does not...
               ok(laurent.uber.walk() === Human.WALKING_LABEL); // but can still access it!
            });      
            
            test("accessing overridden method from inside the overriding one", function() {             
            
               var laurent = new FrenchMan("Laurent");

               // walk() now overridden
               FrenchMan.prototype.walkWithTranslation = function() {
                  return FrenchMan.WALKING_LABEL + " (" + this.uber.walk() + ")";
               }

               ok(laurent.walkWithTranslation() === FrenchMan.WALKING_LABEL + " (" + Human.WALKING_LABEL + ")");
            });               

            test("checking method overridden during the class extension process", function() {             

               var laurent = new FrenchMan("Laurent");
                        
               ok(laurent.sayName() === "Laurent");
               ok(laurent.sayHello() === FrenchMan.GREETING_PREFIX + " " + laurent.sayName());
            });      
            
            test("overriding method in the base class prototype", function() {             
            
               var fabs = new Human("Fabs");
               var laurent = new FrenchMan("Laurent");
            
               Human.prototype.sayName = function() {
                  return "YO";
               }
       
               ok(fabs.sayName() === "YO");
               ok(laurent.sayName() === "YO");      
            });               

            test("overriding method in the subclass prototype", function() {             
            
               var fabs = new Human("Fabs");
               var laurent = new FrenchMan("Laurent");
            
               FrenchMan.prototype.sayName = function() {
                  return "YO";
               }
       
               ok(fabs.sayName() !== "YO");
               ok(laurent.sayName() === "YO");      
            });


            test("parent proto and child proto - relationship", function() {
               var dull = {};
               Human.prototype.sayName = dull;
               Human.prototype.newMethod = function() {};
               ok(FrenchMan.prototype.sayName === dull);
               ok(typeof FrenchMan.prototype.newMethod === "function");
               equal(Human.prototype.isPrototypeOf(FrenchMan.prototype), true); // << very important!
            });
         });
         
      </script>

   </head>

   <body>
      <h1 id="qunit-header">classically</h1>
      <h2 id="qunit-banner"></h2>
      <div id="qunit-testrunner-toolbar"></div>
      <h2 id="qunit-userAgent"></h2>
      <ol id="qunit-tests"></ol>
      <div id="qunit-fixture">test markup, will be hidden</div>
   </body>
</html>